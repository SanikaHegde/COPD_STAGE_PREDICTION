<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COPD Stage Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .form-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 40px auto;
            max-width: 700px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }
        .form-title {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 25px;
        }
        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
        }
        .form-control {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        .btn-submit {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 15px 40px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            width: 100%;
        }
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            color: white;
        }
        .btn-back {
            background: #6c757d;
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 20px;
            text-decoration: none;
            display: inline-block;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .btn-back:hover {
            background: #5a6268;
            color: white;
            text-decoration: none;
            transform: translateY(-1px);
        }
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .result-card {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="btn-back" onclick="history.back()">
            <i class="fas fa-arrow-left"></i> Back to Home
        </div>
        
        <div class="form-container">
            <div class="form-title">
                <h2><i class="fas fa-lungs text-primary"></i> COPD Stage Prediction</h2>
                <p class="text-muted">Enter patient data to predict COPD stage using our AI model</p>
            </div>

            <div class="info-box">
                <h6><i class="fas fa-info-circle text-primary"></i> About COPD Staging</h6>
                <p class="mb-0 small">
                    COPD (Chronic Obstructive Pulmonary Disease) is staged using the GOLD criteria based on 
                    spirometry results, symptoms, and exacerbation history. This AI model analyzes your input 
                    data to predict the most likely COPD stage.
                </p>
            </div>

            <form method="POST">
                <div class="row">
                    {% for column in model_columns %}
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="{{ column }}" class="form-label">
                                <i class="fas fa-chart-line text-info"></i> {{ column.replace('_', ' ') | title }}
                            </label>
                            {% if 'Sex' in column or 'Gender' in column %}
                            <select id="{{ column }}" name="{{ column }}" required class="form-control">
                                <option value="">Select Sex</option>
                                <option value="0">Male</option>
                                <option value="1">Female</option>
                            </select>
                            {% else %}
                            <input type="number" id="{{ column }}" name="{{ column }}" step="any" required 
                                   class="form-control" placeholder="Enter {{ column.replace('_', ' ') }}">
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <div class="info-box">
                    <h6><i class="fas fa-lightbulb text-warning"></i> Clinical Notes</h6>
                    <ul class="mb-0 small">
                        <li>FEV1/FVC ratio < 0.70 confirms airflow limitation</li>
                        <li>FEV1 % predicted determines severity (GOLD 1-4)</li>
                        <li>Consider symptoms and exacerbation history for complete staging</li>
                        <li>This is a screening tool - clinical judgment is essential</li>
                    </ul>
                </div>

                <button type="submit" class="btn btn-submit">
                    <i class="fas fa-brain"></i> Predict COPD Stage
                </button>
            </form>

            {% if prediction %}
            <div class="result-card">
                <h4><i class="fas fa-check-circle text-success"></i> Prediction Result</h4>
                <p class="lead mb-0">The predicted COPD stage is: <strong>{{ prediction }}</strong></p>
            </div>
            {% endif %}

            {% if error %}
            <div class="alert alert-danger mt-4">
                <strong><i class="fas fa-exclamation-triangle"></i> Error:</strong> {{ error }}
            </div>
            {% endif %}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>